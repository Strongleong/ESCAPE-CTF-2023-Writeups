# Bunker Escape

## Description

During the infiltration operation into the bunker, while attempting to escape, we were discovered by the enemy, and all the bunker's doors were shut...! Fortunately, you were still able to intercept the enemy's communication. Decode the communication to gather information!

Author : suriryuk
Points: 150

## Solution

Should be classic Pohlig-Hellman type thing

n = 108506951736793336490683880256855846248083684741694466461336182348417411176781023957825388818844036495751633876599810798436954790114984279939172259886462851438954959031979074506295441495658302003723943179142742062326225122087241430684094279948641138924448463919864585525265270367948313098530841624367001646231
e = 65537

Terminal shows list of huge numbers continuously loading on screen, which are repetition of:
2036295046017029554592558827250389978504009297171635141995321017850956408156217880176445091794538831577452207188372751785425107738901243282510519480235140348861474251724258318445744420728905224779862162281842654717946873831355210852371307510186377109810663851312252715534383547988198506921895221049544022590
37575027881690023592896789531214751324339071798634201243381144078885909309871776459999707639661538809832816523762731336144814773076184762362745510604029738395053773214814099775158166400114070313639131167227705575975092463727540812106587708699677459499462142123816906054855831047820524243826514049131473606896
44638378662797495237588537527696380419060598329695652920169549474299659869405531490922828159027027657701652812711728829903955539284493737370969098515494779713775178033180473988734519938002974831487915719240424268540426017998416587095934878282282899961063954724881617070207962219334963337726915641645376075740
39572521168934688860500761800131891754675815943387093665718065175399710012231012765149908900075517093669336575002712617801689823107954250371529815094072074222208829041696135343433771032595958399003751718117411139391824832520480069478328890918965842244849986096662572359121814154200629412476674249851245181204

decryption exponent (which is inverse of e modulo phi(n)) = 8627641263720189762316763050162134592653982959076092355921431347446528367825898589258405193020679527280189269129829166282481215363675222893373615610546071972296478195761828543453401065564115106602460715420492681794741277617172209519734124125491996504803407929664378216460279290894893869973361852153385806163

Upon exponentiating:
38178729325512603611166078265153021084624132927016267201673997008266433229358
8850581165448023775956536383799137329970902993053393850124267464494240657404462
1939334817670029505627657704600132582495240138779949770852368554068427767876317998
1678028533103037485968933203699195726064605254634557498403

The script to decipher numbers:
```python
from Crypto.Util.number import bytes_to_long, long_to_bytes, getPrime

nums = [
    38178729325512603611166078265153021084624132927016267201673997008266433229358,
    8850581165448023775956536383799137329970902993053393850124267464494240657404462,
    1939334817670029505627657704600132582495240138779949770852368554068427767876317998,
    1678028533103037485968933203699195726064605254634557498403,
]

if __name__ == "__main__":
    for n in nums:
        c = long_to_bytes(n)
        print(c)
```

Using above script, we get:

```text
b'The enemy broke into the bunker.'
b'Lock all the doors of the bunker.'
b'All soldiers search for intruders.'
b'Door Password is T$s15d#'
```

Inputting into link given, we obtain
Flag - ESCAPE{Escape_enemy_bunker!!_you_live!}